
T = 1500;   % Temperature in Kelvin
Cw = logspace(-5, log10(5), 50); % Water content from 10^-5 to 5 (%)
xn = length(Cw);
olivine = zeros(xn);
garnet=zeros(xn);
wadsleyite=zeros(xn);

for i=1:xn
 olivine(i)=Karato_olivine_conductivity(T, Cw(i), 4*1e9);
 garnet(i)=Karato_garnet_conductivity(T,Cw(i), 4*1e9);
 wadsleyite(i)=Karato_wadsleyite_conductivity(T,Cw(i),15*1e9);
end

% High-quality plot settings
figure('Units', 'inches', 'Position', [0 0 7 6], 'PaperPositionMode', 'auto');

plot(Cw, olivine, '-', 'LineWidth', 2, 'MarkerSize', 6, 'MarkerFaceColor', 'blue', 'DisplayName', 'Olivine');
hold on;
plot(Cw, garnet, '-', 'LineWidth', 2, 'MarkerSize', 6, 'MarkerFaceColor', 'red', 'DisplayName', 'Garnet');
hold on;
plot(Cw, wadsleyite, '-', 'LineWidth', 2, 'MarkerSize', 6, 'MarkerFaceColor', 'red', 'DisplayName', 'Garnet');
hold on;

% Set logarithmic scale for both axes
set(gca, 'YScale', 'log', 'XScale', 'log', 'FontSize', 12, 'FontName', 'Helvetica');
ylim([1e-5, 10]);
xlim([1e-5,5]);
xlabel('Water Content (C_w) [wt %]', 'FontSize', 14, 'FontWeight', 'bold');
ylabel('Conductivity (S/m)', 'FontSize', 14, 'FontWeight', 'bold');
title('T = 1500 K', 'FontSize', 16, 'FontWeight', 'bold');
legend({'Olivine', 'Garnet', 'wadsleyite'}, 'Location', 'best', 'FontSize', 12);
set(gca, 'LineWidth', 1.5, 'TickDir', 'out', 'TickLength', [0.02 0.02]);
box on;

% Export the plot as a high-resolution image
print(gcf, 'Conductivity_vs_WaterContent', '-dpng', '-r300'); % 300 DPI for publication
