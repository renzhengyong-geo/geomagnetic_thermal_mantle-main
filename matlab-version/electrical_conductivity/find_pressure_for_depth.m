% Function to find the pressure associated with a given depth using interpolation
function pressure = find_pressure_for_depth(inputDepth)
    % Define the data points (depth in km and pressure in GPa)
    % Depth-pressure data is based on the PREM model and other references.
    data = [
        0, 0.00; 5, 0.15; 10, 0.29; 15, 0.44; 20, 0.58; 25, 0.73; 30, 0.88; 35, 1.02; 40, 1.17; 45, 1.31; 
        50, 1.46; 60, 1.79; 70, 2.12; 80, 2.45; 90, 2.79; 100, 3.12; 110, 3.45; 120, 3.78; 130, 4.12; 140, 4.45;
        150, 4.78; 160, 5.12; 170, 5.45; 180, 5.78; 190, 6.11; 200, 6.45; 210, 6.78; 220, 7.11; 230, 7.45; 240, 7.79;
        250, 8.14; 260, 8.48; 270, 8.82; 280, 9.17; 290, 9.51; 300, 9.86; 310, 10.2; 320, 10.55; 330, 10.9; 340, 11.25;
        350, 11.6; 360, 11.95; 370, 12.3; 380, 12.65; 390, 13.0; 400, 13.35; 410, 13.73; 420, 14.1; 430, 14.48; 440, 14.85;
        450, 15.23; 460, 15.61; 470, 15.99; 480, 16.37; 490, 16.75; 500, 17.13; 510, 17.52; 520, 17.91; 530, 18.29; 540, 18.68;
        550, 19.07; 560, 19.46; 570, 19.86; 580, 20.25; 590, 20.65; 600, 21.04; 610, 21.44; 620, 21.84; 630, 22.24; 640, 22.64;
        650, 23.04; 660, 23.43; 670, 23.83; 680, 24.27; 690, 24.71; 700, 25.15; 710, 25.59; 720, 26.03; 730, 26.48; 740, 26.92;
        750, 27.36; 760, 27.81; 770, 28.25; 780, 28.7; 790, 29.14; 800, 29.59; 810, 30.04; 820, 30.48; 830, 30.93; 840, 31.38;
        850, 31.82; 860, 32.27; 870, 32.72; 880, 33.17; 890, 33.62; 900, 34.07; 910, 34.53; 920, 34.98; 930, 35.43; 940, 35.88;
        950, 36.34; 960, 36.79; 970, 37.24; 980, 37.7; 990, 38.15; 1000, 38.61; 1010, 39.07; 1020, 39.53; 1030, 39.98; 1040, 40.44;
        1050, 40.9; 1060, 41.36; 1070, 41.81; 1080, 42.28; 1090, 42.74; 1100, 43.2; 1110, 43.67; 1120, 44.13; 1130, 44.59; 1140, 45.05;
        1150, 45.52; 1160, 45.98; 1170, 46.44; 1180, 46.91; 1190, 47.38; 1200, 47.85; 1210, 48.31; 1220, 48.78; 1230, 49.25; 1240, 49.72;
        1250, 50.18; 1260, 50.65; 1270, 51.12; 1280, 51.59; 1290, 52.07; 1300, 52.54; 1310, 53.01; 1320, 53.49; 1330, 53.96; 1340, 54.43;
        1350, 54.91; 1360, 55.38; 1370, 55.85; 1380, 56.33; 1390, 56.81; 1400, 57.29; 1410, 57.76; 1420, 58.24; 1430, 58.72; 1440, 59.2;
        1450, 59.68; 1460, 60.16; 1470, 60.64; 1480, 61.12; 1490, 61.6; 1500, 62.09; 1510, 62.57; 1520, 63.05; 1530, 63.54; 1540, 64.02;
        1550, 64.5; 1560, 64.99; 1570, 65.47; 1580, 65.96; 1590, 66.45; 1600, 66.94; 1610, 67.43; 1620, 67.92; 1630, 68.41; 1640, 68.9;
        1650, 69.38; 1660, 69.87; 1670, 70.36; 1680, 70.86; 1690, 71.35; 1700, 71.85; 1710, 72.34; 1720, 72.84; 1730, 73.33; 1740, 73.83;
        1750, 74.32; 1760, 74.82; 1770, 75.31; 1780, 75.81; 1790, 76.31; 1800, 76.81; 1810, 77.31; 1820, 77.81; 1830, 78.31; 1840, 78.81;
        1850, 79.31; 1860, 79.82; 1870, 80.32; 1880, 80.82; 1890, 81.33; 1900, 81.84; 1910, 82.34; 1920, 82.85; 1930, 83.36; 1940, 83.86;
        1950, 84.37; 1960, 84.88; 1970, 85.38; 1980, 85.9; 1990, 86.41; 2000, 86.92; 2010, 87.43; 2020, 87.95; 2030, 88.46; 2040, 88.97;
        2050, 89.49; 2060, 90.0; 2070, 90.51; 2080, 91.03; 2090, 91.55; 2100, 92.07; 2110, 92.59; 2120, 93.11; 2130, 93.63; 2140, 94.15;
        2150, 94.67; 2160, 95.19; 2170, 95.71; 2180, 96.24; 2190, 96.77; 2200, 97.29; 2210, 97.82; 2220, 98.35; 2230, 98.87; 2240, 99.4;
        2250, 99.93; 2260, 100.46; 2270, 100.98; 2280, 101.52; 2290, 102.05; 2300, 102.59; 2310, 103.12; 2320, 103.66; 2330, 104.19; 2340, 104.73;
        2350, 105.26; 2360, 105.8; 2370, 106.33; 2380, 106.88; 2390, 107.42; 2400, 107.96; 2410, 108.51; 2420, 109.05; 2430, 109.59; 2440, 110.14;
        2450, 110.68; 2460, 111.22; 2470, 111.77; 2480, 112.32; 2490, 112.87; 2500, 113.42; 2510, 113.98; 2520, 114.53; 2530, 115.08; 2540, 115.63;
        2550, 116.19; 2560, 116.74; 2570, 117.29; 2580, 117.85; 2590, 118.42; 2600, 118.98; 2610, 119.54; 2620, 120.1; 2630, 120.67; 2640, 121.23;
        2650, 121.79; 2660, 122.35; 2670, 122.92; 2680, 123.49; 2690, 124.06; 2700, 124.63; 2710, 125.2; 2720, 125.77; 2730, 126.35; 2740, 126.92;
        2750, 127.49; 2760, 128.07; 2770, 128.65; 2780, 129.23; 2790, 129.82; 2800, 130.4; 2900, 136.0
    ];

    % If inputDepth is less than or equal to the smallest depth, return the smallest pressure
    if inputDepth <= data(1, 1)
        pressure = data(1, 2);
        return;
    end

    % If inputDepth is greater than or equal to the largest depth, return the largest pressure
    if inputDepth >= data(end, 1)
        pressure = data(end, 2);
        return;
    end

    % Find the index of the first element that is not less than inputDepth
    idx = find(data(:, 1) >= inputDepth, 1);

    % Perform linear interpolation between the found point and the previous point
    pressure = linearInterpolate(data(idx - 1, 1), data(idx - 1, 2), data(idx, 1), data(idx, 2), inputDepth);
end

